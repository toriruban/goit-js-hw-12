{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\nimport axios from \"axios\";\n\nexport const fetchPhotosByQuery = (query, currentPage) => {\n    const axiosOptions = {\n        params: {\n            key: '48301172-ef8913a37f764f18c5dbf5629',\n            q: query,\n            image_type: 'photo', \n            orientation: 'horizontal',\n            safesearch: true,\n            page: currentPage,\n            per_page: 15,\n        },\n    };\n\n    return axios.get(`https://pixabay.com/api/`, axiosOptions);\n};","'use strict';\nexport const createGalleryCardTemplate = image => {\n    return `<div class=\"gallery-item\">\n                   <a href='${image.largeImageURL}'>\n                   <img src='${image.webformatURL}' alt='${image.tags}'/>\n                   </a>\n                  <div class='comment-box'>\n                    <p class='img-comment'><b class='img-comment-title'>Likes</b>: ${image.likes}</p>\n                    <p class='img-comment'><b class='img-comment-title'>Views</b>: ${image.views}</p>\n                    <p class='img-comment'><b class='img-comment-title'>Comments</b>: ${image.comments}</p>\n                    <p class='img-comment'><b class='img-comment-title'>Downloads</b>: ${image.downloads}</p>\n                  </div>\n                </div>`\n}","'use strict';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\"; \n\nimport { fetchPhotosByQuery } from './js/pixabay-api';\nimport { createGalleryCardTemplate } from './js/render-functions';\n\nconst searchForm = document.querySelector('.user-search');\nconst inputSearchImages = document.querySelector('#input-search');\nconst resultsDiv = document.querySelector('#results');\nconst loader = document.querySelector('#loader-js');\nconst loadMore = document.querySelector('.js-load-more-btn');\n\nlet page = 1;\nlet searchedQuery = '';\nlet totalPage = 0;\nlet lightbox = new SimpleLightbox('.gallery a', { captionsData: \"alt\", captionDelay: 250 });\n\nconst onSearchFormSubmit = async event => {\n        event.preventDefault();\n\n        searchedQuery = inputSearchImages.value.trim();\n    \n        if (!searchedQuery) {\n            loadMore.classList.add('is-hidden');\n            iziToast.error({\n                title: 'Error',\n                message: 'The search field cannot be empty. Please try again!',\n                position: 'topRight'\n            });\n            return;\n        }\n\n    resultsDiv.innerHTML = '';\n    inputSearchImages.value = '';\n    loader.classList.remove('hidden');\n\n    page = 1;\n    loadMore.classList.add('is-hidden');\n\n    try {\n        const { data } = await fetchPhotosByQuery(searchedQuery, page);\n    \n            if (data.hits.length === 0) {\n                iziToast.warning({\n                    title: 'No results',\n                    message: 'No images found for your query!',\n                    position: 'topRight',\n                });\n                return;\n            }\n    \n        resultsDiv.innerHTML = data.hits.map(createGalleryCardTemplate).join('');\n        lightbox.refresh();\n    \n        window.scrollTo({ top: resultsDiv.offsetTop, behavior: 'smooth' });\n        \n        totalPage = Math.ceil(data.totalHits / 15);\n    \n            if (totalPage > 1) {\n                loadMore.classList.remove('is-hidden');\n                loadMore.removeEventListener('click', onLoadMoreBtnClick);\n                loadMore.addEventListener('click', onLoadMoreBtnClick);\n            } else {\n                loadMore.classList.add('is-hidden');\n            }\n        } catch (error) {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'An error occurred. Please try again!',\n                    position: 'topRight'\n                });\n            console.error(error);\n        } finally {\n            loader.classList.add('hidden');\n            searchForm.reset();\n        }\n};  \n\nconst onLoadMoreBtnClick = async event => {\n    page++;\n\n    try {\n        const { data } = await fetchPhotosByQuery(searchedQuery, page);\n\n        const galleryTemplate = data.hits.map(createGalleryCardTemplate).join('');\n        resultsDiv.insertAdjacentHTML('beforeend', galleryTemplate);\n        lightbox.refresh();\n\n        const firstCard = document.querySelector('.gallery-item');\n        if (firstCard) {\n            const cardHeight = firstCard.getBoundingClientRect().height;\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: 'smooth'\n            });\n        }\n\n        if (page >= totalPage) {\n            loadMore.classList.add('is-hidden');\n            iziToast.warning({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'bottomCenter',\n            });\n            loadMore.removeEventListener('click', onLoadMoreBtnClick);\n        }\n    } catch (error) {\n        console.error(error);\n        iziToast.error({\n            title: 'Error',\n            message: 'Failed to load more images!',\n            position: 'topRight'\n        });\n    } \n};\nsearchForm.addEventListener('submit', onSearchFormSubmit);"],"names":["fetchPhotosByQuery","query","currentPage","axiosOptions","axios","createGalleryCardTemplate","image","searchForm","inputSearchImages","resultsDiv","loader","loadMore","page","searchedQuery","totalPage","lightbox","SimpleLightbox","onSearchFormSubmit","event","iziToast","data","onLoadMoreBtnClick","error","galleryTemplate","firstCard","cardHeight"],"mappings":"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"}