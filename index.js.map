{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\nimport axios from 'axios';\n\nexport const fetchPhotosByQuery = (query, currentPage = 1) => {\n  return axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '49835598-9f74b1000f2ba2b610eab7f75',\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: currentPage,\n      per_page: 15,\n    },\n  });\n};\n","'use strict';\n\nexport const createGalleryCardTemplate = img => `\n  <li class=\"gallery-item\">\n    <a href=\"${img.largeImageURL}\">\n      <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n    </a>\n    <div class=\"comment-box\">\n      <p class=\"img-comment\"><b>Likes:</b> ${img.likes}</p>\n      <p class=\"img-comment\"><b>Views:</b> ${img.views}</p>\n      <p class=\"img-comment\"><b>Comments:</b> ${img.comments}</p>\n      <p class=\"img-comment\"><b>Downloads:</b> ${img.downloads}</p>\n    </div>\n  </li>`;\n\n","'use strict';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\"; \n\nimport { fetchPhotosByQuery } from './js/pixabay-api';\nimport { createGalleryCardTemplate } from './js/render-functions';\n\nconst searchForm = document.querySelector('.form');\nconst inputSearchImages = document.querySelector('.input-search');\nconst resultsDiv = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.js-load-more-btn');\n\nlet page = 1;\nlet searchedQuery = '';\nlet totalPage = 0;\nlet lightbox = new SimpleLightbox('.gallery a', { captionsData: \"alt\", captionDelay: 250 });\n\nconst onSearchFormSubmit = async event => {\n        event.preventDefault();\n\n        searchedQuery = inputSearchImages.value.trim();\n    \n        if (!searchedQuery) {\n            loadMore.classList.add('is-hidden');\n            iziToast.error({\n                title: 'Error',\n                message: 'The search field cannot be empty. Please try again!',\n                position: 'topRight'\n            });\n            return;\n        }\n\n    resultsDiv.innerHTML = '';\n    inputSearchImages.value = '';\n    loader.classList.remove('hidden');\n\n    page = 1;\n    loadMore.classList.add('is-hidden');\n\n    try {\n        const { data } = await fetchPhotosByQuery(searchedQuery, page);\n    \n            if (data.hits.length === 0) {\n                iziToast.warning({\n                    title: 'No results',\n                    message: 'No images found for your query!',\n                    position: 'topRight',\n                });\n                return;\n            }\n    \n        resultsDiv.innerHTML = data.hits.map(createGalleryCardTemplate).join('');\n        lightbox.refresh();\n    \n        window.scrollTo({ top: resultsDiv.offsetTop, behavior: 'smooth' });\n        \n        totalPage = Math.ceil(data.totalHits / 15);\n    \n            if (totalPage > 1) {\n                loadMore.classList.remove('is-hidden');\n                loadMore.removeEventListener('click', onLoadMoreBtnClick);\n                loadMore.addEventListener('click', onLoadMoreBtnClick);\n            } else {\n                loadMore.classList.add('is-hidden');\n            }\n        } catch (error) {\n                iziToast.error({\n                    title: 'Error',\n                    message: 'An error occurred. Please try again!',\n                    position: 'topRight'\n                });\n            console.error(error);\n        } finally {\n            loader.classList.add('hidden');\n            searchForm.reset();\n        }\n};  \n\nconst onLoadMoreBtnClick = async event => {\n    page++;\n\n    try {\n        const { data } = await fetchPhotosByQuery(searchedQuery, page);\n\n        const galleryTemplate = data.hits.map(createGalleryCardTemplate).join('');\n        resultsDiv.insertAdjacentHTML('beforeend', galleryTemplate);\n        lightbox.refresh();\n\n        const firstCard = document.querySelector('.gallery-item');\n        if (firstCard) {\n            const cardHeight = firstCard.getBoundingClientRect().height;\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: 'smooth'\n            });\n        }\n\n        if (page >= totalPage) {\n            loadMore.classList.add('is-hidden');\n            iziToast.warning({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'bottomCenter',\n            });\n            loadMore.removeEventListener('click', onLoadMoreBtnClick);\n        }\n    } catch (error) {\n        console.error(error);\n        iziToast.error({\n            title: 'Error',\n            message: 'Failed to load more images!',\n            position: 'topRight'\n        });\n    } \n};\nsearchForm.addEventListener('submit', onSearchFormSubmit);"],"names":["fetchPhotosByQuery","query","currentPage","axios","createGalleryCardTemplate","img","searchForm","inputSearchImages","resultsDiv","loader","loadMore","page","searchedQuery","totalPage","lightbox","SimpleLightbox","onSearchFormSubmit","event","iziToast","data","onLoadMoreBtnClick","error","galleryTemplate","firstCard","cardHeight"],"mappings":"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"}